<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  
      xmlns:h="http://java.sun.com/jsf/html"  
      xmlns:f="http://java.sun.com/jsf/core"  
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">  

    <h:head>  

        <f:facet name="last">
            <style type="text/css">
                .ui-panel .ui-panel-content {
                    padding: 0;
                }
                .weekDataTable {
                    display: block;
                    width: 1220px;
                    margin: 10px auto;
                }
                .dayDataTable {
                    width: 150px;
                    float: left;
                    margin: 10px;
                }
            </style>
        </f:facet>
    </h:head>  

    <h:body>
        <p:growl id="growl" globalOnly="true" autoUpdate="true"/>
        <h:form id="weekForm">

            <p:panel id="weekData" header="Series Calendar" styleClass="weekDataTable">
                <ui:repeat id="daysOfweek" var="daysOfweek" value="#{mBDayView.daysOfWeek}" varStatus="index">
                    <p:dataTable id="dayTable" var="seriesList" value="#{daysOfweek.seriesList}" draggableRows="true" styleClass="dayDataTable">
                        <f:facet name="header">#{daysOfweek.day}</f:facet>
                        <p:column style="width:20px">
                            <h:outputText  styleClass="ui-icon ui-icon-arrow-4" />
                        </p:column>
                        <p:column>
                            <p:panel id="dragIcon">
                                #{seriesList.title}
                            </p:panel>
                            <p:draggable for="dragIcon" revert="true" helper="clone" scope="series"/>
                        </p:column>
                    </p:dataTable>
                    <p:droppable id="dayTableDrop" for="dayTable" tolerance="pointer" scope="series" datasource="daysTable"
                                 activeStyleClass="ui-state-default" hoverStyleClass="ui-state-hover">
                        <p:ajax listener="#{mBDragNDrop.onDragNDrop}"/>
                    </p:droppable>
                </ui:repeat>
                <div style="clear: both;"></div>
                <p:commandButton value="Update" process="@this" update="weekData" action="#{mBUpdateCalendar.update}"/>
                <p:commandButton value="Save" process="@this weekData" action="#{mBSaveCalendar.save}" rendered="#{not empty mBDayView.daysOfWeek}"/>
                <p:commandButton value="Clear" process="@this" update="weekData" action="#{mBUpdateCalendar.clear}" rendered="#{not empty mBDayView.daysOfWeek}"/>

                <p:dataTable id="daysTable" var="seriesList" value="#{mBDayView.printSeries()}" >
                    <p:column>
                        #{seriesList.title}
                    </p:column>
                </p:dataTable>
            </p:panel>

            <p:panel id="pnl" style="width: 200px; height: 200px;">
                <p>Drop here...</p>
            </p:panel>
            <p:droppable id="pnlDrop" for="pnl" tolerance="pointer" scope="series" datasource="dayTable"
                         activeStyleClass="ui-state-default" hoverStyleClass="ui-state-hover">
                <p:ajax listener="#{mBDragNDrop.onDragNDrop}"/>
            </p:droppable>
        </h:form>

        <h:form id="form">
            <p:dataTable id="tableX" var="seriesList" value="#{mBDayView.testDay.seriesList}" draggableRows="true">

                <f:facet name="header">#{seriesList.day}</f:facet>
                <p:column style="width:20px">
                    <h:outputText  styleClass="ui-icon ui-icon-arrow-4" />
                </p:column>
                <p:column>
                    <p:panel id="dragIconX">
                        <f:attribute name="seriesDay" value="#{seriesList.day}"/>
                        <f:attribute name="seriesTitle" value="#{seriesList.title}"/>
                        #{seriesList.title}
                    </p:panel>
                    <p:draggable for="dragIconX" revert="true" helper="clone" scope="seriesX"/>
                </p:column>
            </p:dataTable>
            <div style="clear: both;"></div>
            <p:panel id="pnlX" style="width: 200px; height: 200px;">
                <p>Drop here...</p>
            </p:panel>
            <p:droppable id="pnlDropX" for="pnlX" tolerance="pointer" scope="seriesX"  datasource="tableX"
                         activeStyleClass="ui-state-default" hoverStyleClass="ui-state-hover">
                <p:ajax listener="#{mBDragNDrop.onDragNDrop}"/>
            </p:droppable>
        </h:form>


    </h:body>  
</html> 
