<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  
      xmlns:h="http://java.sun.com/jsf/html"  
      xmlns:f="http://java.sun.com/jsf/core"  
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">  

    <h:head>  

        <f:facet name="last">
            <style type="text/css">
                .ui-panel .ui-panel-content {
                    padding: 0;
                }
                .dayDataTable {
                    width: 150px;
                    float: left;
                    margin: 10px;
                }
            </style>
        </f:facet>
    </h:head>  

    <h:body>  



        <h:form id="weekForm">

            <p:growl id="growl" globalOnly="true" autoUpdate="true"/>
            <p:panel id="weekData" header="Series Calendar">
                <ui:repeat var="daysOfweek" value="#{mBDayView.daysOfWeek}">
                    <p:dataTable id="dayTable" var="seriesDay" value="#{daysOfweek.series}" draggableRows="true" styleClass="dayDataTable">
                        <p:ajax event="rowReorder" listener="#{mBDragNDrop.onDragNDrop}"/>
                        <f:facet name="header">#{daysOfweek.day}</f:facet>
                        <p:column>
                            <h:outputText id="dragIcon" value="#{seriesDay}">
                                <f:attribute name="seriesDay" value="#{daysOfweek.day}"/>
                                <f:attribute name="seriesTitle" value="#{seriesDay}"/>
                            </h:outputText>
                            <p:draggable for="dragIcon" revert="true" helper="clone"/>
                        </p:column>
                    </p:dataTable>
                </ui:repeat>
            </p:panel>
            <div style="clear: both;"></div>

            <p:commandButton id="updateBtn" value="Update" process="@this" update="weekData saveBtn clearBtn" action="#{mBUpdateCalendar.update}"/>
            <p:commandButton id="saveBtn" value="Save" process="@this weekData" action="#{mBSaveCalendar.save}" rendered="#{not empty mBDayView.daysOfWeek}"/>
            <p:commandButton id="clearBtn" value="Clear" process="@this" update="weekData saveBtn clearBtn" action="#{mBUpdateCalendar.clear}" rendered="#{not empty mBDayView.daysOfWeek}"/>



            <p:panel id="pnl" style="width: 200px; height: 200px;">
                <p>Drop here...</p>
            </p:panel>
            <p:droppable id="pnlDrop" for="pnl" tolerance="pointer" 
                         activeStyleClass="ui-state-default" hoverStyleClass="ui-state-hover">
                <p:ajax listener="#{mBDragNDrop.onDragNDrop}"/>
            </p:droppable>
        </h:form>

    </h:body>  
</html> 
